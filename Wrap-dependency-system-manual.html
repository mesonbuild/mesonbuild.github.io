<!DOCTYPE html>
<html lang="en">
<head>

<base href=".">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>Wrap dependency system manual</title>

<link rel="stylesheet" href="assets/css/custom_bootstrap.css" type="text/css">
<link rel="stylesheet" href="assets/css/bootstrap-toc.min.css" type="text/css">
<link rel="stylesheet" href="assets/css/frontend.css" type="text/css">
<link rel="stylesheet" href="assets/css/jquery.mCustomScrollbar.min.css">

<link rel="stylesheet" href="assets/css/prism-tomorrow.css" type="text/css">

<script src="assets/js/mustache.min.js"></script>
<script src="assets/js/jquery.js"></script>
<script src="assets/js/scrollspy.js"></script>
<script src="assets/js/bootstrap.js"></script>
<script src="assets/js/typeahead.jquery.min.js"></script>
<script src="assets/js/search.js"></script>
<script src="assets/js/isotope.pkgd.min.js"></script>
<script src="assets/js/compare-versions.js"></script>
<script src="assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="assets/js/bootstrap-toc.min.js"></script>
<script src="assets/js/jquery.touchSwipe.min.js"></script>
<script src="assets/js/anchor.min.js"></script>
<script src="assets/js/tag_filtering.js"></script>
<script src="assets/js/language_switching.js"></script>

<script src="assets/js/lines_around_headings.js"></script>

<script src="assets/js/prism-core.js"></script>
<script src="assets/js/prism-autoloader.js"></script>
<script src="assets/js/prism_autoloader_path_override.js"></script>
<script src="assets/js/trie.js"></script>

<link rel="icon" type="image/png" href="assets/images/favicon.png">
<link rel="shortcut icon" href="assets/images/favicon.png">

</head>

<body class="no-script
" data-spy="scroll" data-target="#toc" data-offset="70">

<script>
$('body').removeClass('no-script');
</script>

<nav class="navbar navbar-fixed-top navbar-default" id="topnav">
	<div class="container-fluid">
		<div class="navbar-right">
			<a id="toc-toggle">
				<span class="glyphicon glyphicon-menu-right"></span>
				<span class="glyphicon glyphicon-menu-left"></span>
			</a>
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-wrapper" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<form class="navbar-form pull-right" id="navbar-search-form">
                               <div class="form-group has-feedback">
                                       <input type="text" class="form-control input-sm" name="search" id="sidenav-lookup-field" placeholder="search" disabled>
				       <span class="glyphicon glyphicon-search form-control-feedback" id="search-mgn-glass"></span>
                               </div>
                        </form>
		</div>
		<div class="navbar-header">
			<a id="sidenav-toggle">
				<span class="glyphicon glyphicon-menu-right"></span>
				<span class="glyphicon glyphicon-menu-left"></span>
			</a>
			<a id="home-link" href="index.html" class="hotdoc-navbar-brand">
				<img src="assets/images/meson_logo.png" alt="Home">
			</a>
		</div>
		<div class="navbar-collapse collapse" id="navbar-wrapper">
			<ul class="nav navbar-nav" id="menu">
				
<li class="dropdown">
  <a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Modules <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" id="modules-menu">
			<li>
				<a href="CMake-module.html">CMake</a>
			</li>
					<li>
				<a href="Cuda-module.html">CUDA</a>
			</li>
					<li>
				<a href="Dlang-module.html">Dlang</a>
			</li>
					<li>
				<a href="Fs-module.html">Filesystem</a>
			</li>
					<li>
				<a href="Gnome-module.html">GNOME</a>
			</li>
					<li>
				<a href="Hotdoc-module.html">Hotdoc</a>
			</li>
					<li>
				<a href="i18n-module.html">i18n</a>
			</li>
					<li>
				<a href="Icestorm-module.html">Icestorm</a>
			</li>
					<li>
				<a href="Keyval-module.html">Keyval</a>
			</li>
					<li>
				<a href="Pkgconfig-module.html">Pkgconfig</a>
			</li>
					<li>
				<a href="Python-module.html">Python</a>
			</li>
					<li>
				<a href="Python-3-module.html">Python 3</a>
			</li>
					<li>
				<a href="Qt4-module.html">Qt4</a>
			</li>
					<li>
				<a href="Qt5-module.html">Qt5</a>
			</li>
					<li>
				<a href="RPM-module.html">RPM</a>
			</li>
					<li>
				<a href="SourceSet-module.html">SourceSet</a>
			</li>
					<li>
				<a href="Windows-module.html">Windows</a>
			</li>
			</ul>
</li>
<li class="dropdown">
	<a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		Quick References <span class="caret"></span>
	</a>
	<ul class="dropdown-menu" id="quick-refs-menu">
					<li>
				<a href="Reference-manual.html">Functions</a>
			</li>
					<li>
				<a href="Build-options.html">Options</a>
			</li>
					<li>
				<a href="Configuration.html">Configuration</a>
			</li>
					<li>
				<a href="Dependencies.html">Dependencies</a>
			</li>
					<li>
				<a href="Unit-tests.html">Tests</a>
			</li>
					<li>
				<a href="Syntax.html">Syntax</a>
			</li>
			</ul>
</li>
			</ul>
			<div class="hidden-xs hidden-sm navbar-text navbar-center">
				<p><b>The Meson Build System</b></p>
			</div>
		</div>
	</div>
</nav>

<main>
<div data-extension="core" data-hotdoc-in-toplevel="True" data-hotdoc-project="Meson-documentation" data-hotdoc-ref="Wrap-dependency-system-manual.html" class="page_container" id="page-wrapper">
<script src="assets/js/utils.js"></script>

<div class="panel panel-collapse oc-collapsed" id="sidenav" data-hotdoc-role="navigation">
	<script src="assets/js/navigation.js"></script>
	<script src="assets/js/sitemap.js"></script>
</div>

<div id="body">
	<div id="main">
				    <div id="page-description" data-hotdoc-role="main">
        <h1 id="wrap-dependency-system-manual">Wrap dependency system manual</h1>
<p>One of the major problems of multiplatform development is wrangling
all your dependencies. This is awkward on many platforms, especially
on ones that do not have a built-in package manager. The latter problem
has been worked around by having third party package managers. They
are not really a solution for end user deployment, because you can't
tell them to install a package manager just to use your app. On these
platforms you must produce self-contained applications. Same applies
when destination platform is missing (up-to-date versions of) your
application's dependencies.</p>
<p>The traditional approach to this has been to bundle dependencies
inside your own project. Either as prebuilt libraries and headers or
by embedding the source code inside your source tree and rewriting
your build system to build them as part of your project.</p>
<p>This is both tedious and error prone because it is always done by
hand. The Wrap dependency system of Meson aims to provide an automated
way to do this.</p>
<h2 id="how-it-works">How it works</h2>
<p>Meson has a concept of <a href="Subprojects.html">subprojects</a>. They are a way
of nesting one Meson project inside another. Any project that builds
with Meson can detect that it is built as a subproject and build
itself in a way that makes it easy to use (usually this means as a
static library).</p>
<p>To use this kind of a project as a dependency you could just copy and
extract it inside your project's <code>subprojects</code> directory.</p>
<p>However there is a simpler way. You can specify a Wrap file that tells Meson
how to download it for you. If you then use this subproject in your build,
Meson will automatically download and extract it during build. This makes
subproject embedding extremely easy.</p>
<p>All wrap files must have a name of <code>&lt;project_name&gt;.wrap</code> form and be in <code>subprojects</code> dir.</p>
<p>Currently Meson has four kinds of wraps:</p>
<ul>
<li>wrap-file</li>
<li>wrap-git</li>
<li>wrap-hg</li>
<li>wrap-svn</li>
</ul>
<h2 id="wrap-format">wrap format</h2>
<p>Wrap files are written in ini format, with a single header containing the type
of wrap, followed by properties describing how to obtain the sources, validate
them, and modify them if needed. An example wrap-file for the wrap named
<code>libfoobar</code> would have a filename <code>libfoobar.wrap</code> and would look like this:</p>
<pre><code class="language-ini">[wrap-file]
directory = libfoobar-1.0

source_url = https://example.com/foobar-1.0.tar.gz
source_filename = foobar-1.0.tar.gz
source_hash = 5ebeea0dfb75d090ea0e7ff84799b2a7a1550db3fe61eb5f6f61c2e971e57663
</code></pre>
<p>An example wrap-git will look like this:</p>
<pre><code class="language-ini">[wrap-git]
url = https://github.com/libfoobar/libfoobar.git
revision = head
</code></pre>
<h2 id="accepted-configuration-properties-for-wraps">Accepted configuration properties for wraps</h2>
<ul>
<li>
<code>directory</code> - name of the subproject root directory, defaults to the name of the wrap.</li>
</ul>
<h3 id="specific-to-wrapfile">Specific to wrap-file</h3>
<ul>
<li>
<code>source_url</code> - download url to retrieve the wrap-file source archive</li>
<li>
<code>source_fallback_url</code> - fallback URL to be used when download from <code>source_url</code> fails <em>Since: 0.55.0</em>
</li>
<li>
<code>source_filename</code> - filename of the downloaded source archive</li>
<li>
<code>source_hash</code> - sha256 checksum of the downloaded source archive</li>
<li>
<code>patch_url</code> - download url to retrieve an optional overlay archive</li>
<li>
<code>patch_fallback_url</code> - fallback URL to be used when download from <code>patch_url</code> fails <em>Since: 0.55.0</em>
</li>
<li>
<code>patch_filename</code> - filename of the downloaded overlay archive</li>
<li>
<code>patch_hash</code> - sha256 checksum of the downloaded overlay archive</li>
<li>
<code>lead_directory_missing</code> - for <code>wrap-file</code> create the leading
directory name. Needed when the source file does not have a leading
directory.</li>
</ul>
<p>Since <em>0.55.0</em> it is possible to use only the <code>source_filename</code> and
<code>patch_filename</code> value in a .wrap file (without <code>source_url</code> and <code>patch_url</code>) to
specify a local archive in the <code>subprojects/packagefiles</code> directory. The <code>*_hash</code>
entries are optional when using this method. This method should be prefered over
the old <code>packagecache</code> approach described below.</p>
<p>Since <em>0.49.0</em> if <code>source_filename</code> or <code>patch_filename</code> is found in the
project's <code>subprojects/packagecache</code> directory, it will be used instead
of downloading the file, even if <code>--wrap-mode</code> option is set to
<code>nodownload</code>. The file's hash will be checked.</p>
<h3 id="specific-to-vcsbased-wraps">Specific to VCS-based wraps</h3>
<ul>
<li>
<code>url</code> - name of the wrap-git repository to clone. Required.</li>
<li>
<code>revision</code> - name of the revision to checkout. Must be either: a
valid value (such as a git tag) for the VCS's <code>checkout</code> command, or
(for git) <code>head</code> to track upstream's default branch. Required.</li>
</ul>
<h2 id="specific-to-wrapgit">Specific to wrap-git</h2>
<ul>
<li>
<code>depth</code> - shallowly clone the repository to X number of commits. Note
that git always allow shallowly cloning branches, but in order to
clone commit ids shallowly, the server must support
<code>uploadpack.allowReachableSHA1InWant=true</code>.  <em>(since 0.52.0)</em>
</li>
<li>
<code>push-url</code> - alternative url to configure as a git push-url. Useful if
the subproject will be developed and changes pushed upstream.
<em>(since 0.37.0)</em>
</li>
<li>
<code>clone-recursive</code> - also clone submodules of the repository
<em>(since 0.48.0)</em>
</li>
</ul>
<h2 id="wrapfile-with-meson-build-patch">wrap-file with Meson build patch</h2>
<p>Unfortunately most software projects in the world do not build with
Meson. Because of this Meson allows you to specify a patch URL.</p>
<p>For historic reasons this is called a "patch", however, it serves as an
overlay to add or replace files rather than modifying them. The file
must be an archive; it is downloaded and automatically extracted into
the subproject. The extracted files will include a meson build
definition for the given subproject.</p>
<p>This approach makes it extremely simple to embed dependencies that
require build system changes. You can write the Meson build definition
for the dependency in total isolation. This is a lot better than doing
it inside your own source tree, especially if it contains hundreds of
thousands of lines of code. Once you have a working build definition,
just zip up the Meson build files (and others you have changed) and
put them somewhere where you can download them.</p>
<p>Meson build patches are only supported for wrap-file mode. When using
wrap-git, the repository must contain all Meson build definitions.</p>
<h2 id="using-wrapped-projects">Using wrapped projects</h2>
<p>Wraps provide a convenient way of obtaining a project into your subproject directory.
Then you use it as a regular subproject (see <a href="Subprojects.html">subprojects</a>).</p>
<h2 id="getting-wraps">Getting wraps</h2>
<p>Usually you don't want to write your wraps by hand.</p>
<p>There is an online repository called <a href="https://wrapdb.mesonbuild.com">WrapDB</a> that provides
many dependencies ready to use. You can read more about WrapDB <a href="Using-the-WrapDB.html">here</a>.</p>
<p>There is also a Meson subcommand to get and manage wraps (see <a href="Using-wraptool.html">using wraptool</a>).</p>

    </div>
        




		<div id="subpages">
	<p><b>Subpages:</b></p>
	<div class="thumb-subpages">
																																																											</div>
							<p>
			<a href="Adding-new-projects-to-wrapdb.html">Adding new projects to WrapDB</a>
						</p>
									<p>
			<a href="Using-the-WrapDB.html">Using the WrapDB</a>
						</p>
									<p>
			<a href="Using-wraptool.html">Using wraptool</a>
						</p>
									<p>
			<a href="Wrap-maintainer-tools.html">Wrap maintainer tools</a>
						</p>
									<p>
			<a href="Wrap-best-practices-and-tips.html">Wrap best practices and tips</a>
						</p>
									<p>
			<a href="Wrap-review-guidelines.html">Wrap review guidelines</a>
						</p>
									<p>
			<a href="Shipping-prebuilt-binaries-as-wraps.html">Shipping prebuilt binaries as wraps</a>
						</p>
									<p>
			<a href="fallback-wraptool.html">fallback wraptool</a>
						</p>
			</div>
	</div>
	<div id="search_results">
		<p>The results of the search are</p>
	</div>
	<div id="footer">
		    
        
<hr>

<div class="license-description">
    Website licensing information are available on the <a href="legal.html">Legal</a> page.
</div>


	</div>
</div>

<div id="toc-column">
	
		<div class="edit-button">
		<a href="https://github.com/mesonbuild/meson//edit/master/docs/markdown/Wrap-dependency-system-manual.md" data-hotdoc-role="edit-button">Edit on github</a>

	</div>
		<div id="toc-wrapper">
		<nav id="toc"></nav>
	</div>
</div>
</div>
</main>


<script src="assets/js/navbar_offset_scroller.js"></script>
</body>
</html>
