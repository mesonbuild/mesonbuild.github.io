<!DOCTYPE html>
<html lang="en">
<head>

<base href=".">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>How do I do X in Meson?</title>

<link rel="stylesheet" href="assets/css/custom_bootstrap.css" type="text/css">
<link rel="stylesheet" href="assets/css/bootstrap-toc.min.css" type="text/css">
<link rel="stylesheet" href="assets/css/frontend.css" type="text/css">
<link rel="stylesheet" href="assets/css/jquery.mCustomScrollbar.min.css">
<link rel="stylesheet" href="assets/js/search/enable_search.css" type="text/css">

<link rel="stylesheet" href="assets/css/prism-tomorrow.css" type="text/css">

<script src="assets/js/mustache.min.js"></script>
<script src="assets/js/jquery.js"></script>
<script src="assets/js/scrollspy.js"></script>
<script src="assets/js/bootstrap.js"></script>
<script src="assets/js/typeahead.jquery.min.js"></script>
<script src="assets/js/search.js"></script>
<script src="assets/js/isotope.pkgd.min.js"></script>
<script src="assets/js/compare-versions.js"></script>
<script src="assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="assets/js/bootstrap-toc.min.js"></script>
<script src="assets/js/jquery.touchSwipe.min.js"></script>
<script src="assets/js/anchor.min.js"></script>
<script src="assets/js/tag_filtering.js"></script>
<script src="assets/js/language_switching.js"></script>

<script src="assets/js/lines_around_headings.js"></script>

<script src="assets/js/prism-core.js"></script>
<script src="assets/js/prism-autoloader.js"></script>
<script src="assets/js/prism_autoloader_path_override.js"></script>
<script src="assets/js/trie.js"></script>

<link rel="icon" type="image/png" href="assets/images/favicon.png">
<link rel="shortcut icon" href="assets/images/favicon.png">

</head>

<body class="no-script
" data-spy="scroll" data-target="#toc" data-offset="70">

<script>
$('body').removeClass('no-script');
</script>

<nav class="navbar navbar-fixed-top navbar-default" id="topnav">
	<div class="container-fluid">
		<div class="navbar-right">
			<a id="toc-toggle">
				<span class="glyphicon glyphicon-menu-right"></span>
				<span class="glyphicon glyphicon-menu-left"></span>
			</a>
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-wrapper" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<form class="navbar-form pull-right" id="navbar-search-form">
                               <div class="form-group has-feedback">
                                       <input type="text" class="form-control input-sm" name="search" id="sidenav-lookup-field" placeholder="search" disabled>
				       <span class="glyphicon glyphicon-search form-control-feedback" id="search-mgn-glass"></span>
                               </div>
                        </form>
		</div>
		<div class="navbar-header">
			<a id="sidenav-toggle">
				<span class="glyphicon glyphicon-menu-right"></span>
				<span class="glyphicon glyphicon-menu-left"></span>
			</a>
			<a id="home-link" href="index.html" class="hotdoc-navbar-brand">
				<img src="assets/images/meson_logo.png" alt="Home">
			</a>
		</div>
		<div class="navbar-collapse collapse" id="navbar-wrapper">
			<ul class="nav navbar-nav" id="menu">
				
<li class="dropdown">
  <a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Modules <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" id="modules-menu">
			<li>
				<a href="CMake-module.html">CMake</a>
			</li>
					<li>
				<a href="Cuda-module.html">CUDA</a>
			</li>
					<li>
				<a href="Dlang-module.html">Dlang</a>
			</li>
					<li>
				<a href="Fs-module.html">Filesystem</a>
			</li>
					<li>
				<a href="Gnome-module.html">GNOME</a>
			</li>
					<li>
				<a href="Hotdoc-module.html">Hotdoc</a>
			</li>
					<li>
				<a href="i18n-module.html">i18n</a>
			</li>
					<li>
				<a href="Icestorm-module.html">Icestorm</a>
			</li>
					<li>
				<a href="Keyval-module.html">Keyval</a>
			</li>
					<li>
				<a href="Pkgconfig-module.html">Pkgconfig</a>
			</li>
					<li>
				<a href="Python-module.html">Python</a>
			</li>
					<li>
				<a href="Python-3-module.html">Python 3</a>
			</li>
					<li>
				<a href="Qt4-module.html">Qt4</a>
			</li>
					<li>
				<a href="Qt5-module.html">Qt5</a>
			</li>
					<li>
				<a href="RPM-module.html">RPM</a>
			</li>
					<li>
				<a href="SourceSet-module.html">SourceSet</a>
			</li>
					<li>
				<a href="Windows-module.html">Windows</a>
			</li>
			</ul>
</li>
<li class="dropdown">
	<a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		Quick References <span class="caret"></span>
	</a>
	<ul class="dropdown-menu" id="quick-refs-menu">
					<li>
				<a href="Reference-manual.html">Functions</a>
			</li>
					<li>
				<a href="Build-options.html">Options</a>
			</li>
					<li>
				<a href="Configuration.html">Configuration</a>
			</li>
					<li>
				<a href="Dependencies.html">Dependencies</a>
			</li>
					<li>
				<a href="Unit-tests.html">Tests</a>
			</li>
					<li>
				<a href="Syntax.html">Syntax</a>
			</li>
			</ul>
</li>
			</ul>
			<div class="hidden-xs hidden-sm navbar-text navbar-center">
				<p><b>The Meson Build System</b></p>
			</div>
		</div>
	</div>
</nav>

<main>
<div data-extension="core" data-hotdoc-in-toplevel="True" data-hotdoc-project="Meson-documentation" data-hotdoc-ref="howtox.html" class="page_container" id="page-wrapper">
<script src="assets/js/utils.js"></script>

<div class="panel panel-collapse oc-collapsed" id="sidenav" data-hotdoc-role="navigation">
	<script src="assets/js/navigation.js"></script>
	<script src="assets/js/sitemap.js"></script>
</div>

<div id="body">
	<div id="main">
				    <div id="page-description" data-hotdoc-role="main">
        <h1 id="how-do-i-do-x-in-meson">How do I do X in Meson?</h1>
<p>This page lists code snippets for common tasks. These are written
mostly using the C compiler, but the same approach should work on
almost all other compilers.</p>
<h2 id="set-compiler">Set compiler</h2>
<p>When first running Meson, set it in an environment variable.</p>
<pre><code class="language-console">$ CC=mycc meson &lt;options&gt;
</code></pre>
<p>Note that environment variables like <code>CC</code> only works in native builds. The <code>CC</code>
refers to the compiler for the host platform, that is the compiler used to
compile programs that run on the machine we will eventually install the project
on. The compiler used to build things that run on the machine we do the
building can be specified with <code>CC_FOR_BUILD</code>. You can use it in cross builds.</p>
<p>Note that environment variables are never the idiomatic way to do anything with
Meson, however. It is better to use the native and cross files. And the tools
for the host platform in cross builds can only be specified with a cross file.</p>
<p>There is a table of all environment variables supported <a href="Reference-tables.html#compiler-and-linker-selection-variables">Here</a></p>
<h2 id="set-linker">Set linker</h2>
<p><em>New in 0.53.0</em></p>
<p>Like the compiler, the linker is selected via the <code>&lt;compiler variable&gt;_LD</code>
environment variable, or through the <code>&lt;compiler entry&gt;_ld</code> entry in a native
or cross file. You must be aware of whether you're using a compiler that
invokes the linker itself (most compilers including GCC and Clang) or a
linker that is invoked directly (when using MSVC or compilers that act like
it, including Clang-Cl). With the former <code>c_ld</code> or <code>CC_LD</code> should be the value
to pass to the compiler's special argument (such as <code>-fuse-ld</code> with clang and
gcc), with the latter it should be an executable, such as <code>lld-link.exe</code>.</p>
<p><em>NOTE</em> In meson 0.53.0 the <code>ld</code> entry in the cross/native file and the <code>LD</code>
environment variable were used, this resulted in a large number of regressions
and was changed in 0.53.1 to <code>&lt;lang&gt;_ld</code> and <code>&lt;comp variable&gt;_LD</code>.</p>
<pre><code class="language-console">$ CC=clang CC_LD=lld meson &lt;options&gt;
</code></pre>
<p>or</p>
<pre><code class="language-console">$ CC=clang-cl CC_LD=link meson &lt;options&gt;
</code></pre>
<p>or in a cross or native file:</p>
<pre><code class="language-ini">[binaries]
c = 'clang'
c_ld = 'lld'
</code></pre>
<p>There is a table of all environment variables supported <a href="Reference-tables.html#compiler-and-linker-selection-variables">Here</a></p>
<h2 id="set-default-cc-language-version">Set default C/C++ language version</h2>
<pre><code class="language-meson">project('myproj', 'c', 'cpp',
        default_options : ['c_std=c11', 'cpp_std=c++11'])
</code></pre>
<p>The language version can also be set on a per-target basis.</p>
<pre><code class="language-meson">executable(..., override_options : ['c_std=c11'])
</code></pre>
<h2 id="enable-threads">Enable threads</h2>
<p>Lots of people seem to do this manually with <code>find_library('pthread')</code>
or something similar. Do not do that. It is not portable. Instead do
this.</p>
<pre><code class="language-meson">thread_dep = dependency('threads')
executable(..., dependencies : thread_dep)
</code></pre>
<h2 id="set-extra-compiler-and-linker-flags-from-the-outside-when-eg-building-distro-packages">Set extra compiler and linker flags from the outside (when e.g. building distro packages)</h2>
<p>The behavior is the same as with other build systems, with environment
variables during first invocation. Do not use these when you need to rebuild
the source</p>
<pre><code class="language-console">$ CFLAGS=-fsomething LDFLAGS=-Wl,--linker-flag meson &lt;options&gt;
</code></pre>
<h2 id="use-an-argument-only-with-a-specific-compiler">Use an argument only with a specific compiler</h2>
<p>First check which arguments to use.</p>
<pre><code class="language-meson">if meson.get_compiler('c').get_id() == 'clang'
  extra_args = ['-fclang-flag']
else
  extra_args = []
endif
</code></pre>
<p>Then use it in a target.</p>
<pre><code class="language-meson">executable(..., c_args : extra_args)
</code></pre>
<p>If you want to use the arguments on all targets, then do this.</p>
<pre><code class="language-meson">if meson.get_compiler('c').get_id() == 'clang'
  add_global_arguments('-fclang-flag', language : 'c')
endif
</code></pre>
<h2 id="set-a-commands-output-to-configuration">Set a command's output to configuration</h2>
<pre><code class="language-meson">txt = run_command('script', 'argument').stdout().strip()
cdata = configuration_data()
cdata.set('SOMETHING', txt)
configure_file(...)
</code></pre>
<h2 id="generate-a-runnable-script-with-configure_file">Generate a runnable script with <code>configure_file</code>
</h2>
<p><code>configure_file</code> preserves metadata so if your template file has
execute permissions, the generated file will have them too.</p>
<h2 id="producing-a-coverage-report">Producing a coverage report</h2>
<p>First initialize the build directory with this command.</p>
<pre><code class="language-console">$ meson &lt;other flags&gt; -Db_coverage=true
</code></pre>
<p>Then issue the following commands.</p>
<pre><code class="language-console">$ meson compile
$ meson test
$ meson compile coverage-html (or coverage-xml)
</code></pre>
<p>The coverage report can be found in the meson-logs subdirectory.</p>
<p><em>New in 0.55.0</em> llvm-cov support for use with clang</p>
<h2 id="add-some-optimization-to-debug-builds">Add some optimization to debug builds</h2>
<p>By default the debug build does not use any optimizations. This is the
desired approach most of the time. However some projects benefit from
having some minor optimizations enabled. GCC even has a specific
compiler flag <code>-Og</code> for this. To enable its use, just issue the
following command.</p>
<pre><code class="language-console">$ meson configure -Dc_args=-Og
</code></pre>
<p>This causes all subsequent builds to use this command line argument.</p>
<h2 id="use-address-sanitizer">Use address sanitizer</h2>
<p>Clang comes with a selection of analysis tools such as the <a href="https://clang.llvm.org/docs/AddressSanitizer.html">address
sanitizer</a>. Meson
has native support for these with the <code>b_sanitize</code> option.</p>
<pre><code class="language-console">$ meson &lt;other options&gt; -Db_sanitize=address
</code></pre>
<p>After this you just compile your code and run the test suite. Address
sanitizer will abort executables which have bugs so they show up as
test failures.</p>
<h2 id="use-clang-static-analyzer">Use Clang static analyzer</h2>
<p>Install scan-build and configure your project. Then do this:</p>
<pre><code class="language-console">$ meson compile scan-build
</code></pre>
<p>You can use the <code>SCANBUILD</code> environment variable to choose the
scan-build executable.</p>
<pre><code class="language-console">$ SCANBUILD=&lt;your exe&gt; meson compile scan-build
</code></pre>
<h2 id="use-profile-guided-optimization">Use profile guided optimization</h2>
<p>Using profile guided optimization with GCC is a two phase
operation. First we set up the project with profile measurements
enabled and compile it.</p>
<pre><code class="language-console">$ meson setup &lt;Meson options, such as --buildtype=debugoptimized&gt; -Db_pgo=generate
$ meson compile -C builddir
</code></pre>
<p>Then we need to run the program with some representative input. This
step depends on your project.</p>
<p>Once that is done we change the compiler flags to use the generated
information and rebuild.</p>
<pre><code class="language-console">$ meson configure -Db_pgo=use
$ meson compile
</code></pre>
<p>After these steps the resulting binary is fully optimized.</p>
<h2 id="add-math-library-lm-portably">Add math library (<code>-lm</code>) portably</h2>
<p>Some platforms (e.g. Linux) have a standalone math library. Other
platforms (pretty much everyone else) do not. How to specify that <code>m</code>
is used only when needed?</p>
<pre><code class="language-meson">cc = meson.get_compiler('c')
m_dep = cc.find_library('m', required : false)
executable(..., dependencies : m_dep)
</code></pre>
<h2 id="install-an-executable-to-libexecdir">Install an executable to <code>libexecdir</code>
</h2>
<pre><code class="language-meson">executable(..., install : true, install_dir : get_option('libexecdir'))
</code></pre>
<h2 id="use-existing-findnamecmake-files">Use existing <code>Find&lt;name&gt;.cmake</code> files</h2>
<p>Meson can use the CMake <code>find_package()</code> ecosystem if CMake is installed.
To find a dependency with custom <code>Find&lt;name&gt;.cmake</code>, set the <code>cmake_module_path</code>
property to the path in your project where the CMake scripts are stored.</p>
<p>Example for a <code>FindCmakeOnlyDep.cmake</code> in a <code>cmake</code> subdirectory:</p>
<pre><code class="language-meson">cm_dep = dependency('CmakeOnlyDep', cmake_module_path : 'cmake')
</code></pre>
<p>The <code>cmake_module_path</code> property is only needed for custom CMake scripts. System
wide CMake scripts are found automatically.</p>
<p>More information can be found <a href="Dependencies.html#cmake">here</a></p>
<h2 id="get-a-default-notfound-dependency">Get a default not-found dependency?</h2>
<pre><code class="language-meson">null_dep = dependency('', required : false)
</code></pre>
<p>This can be used in cases where you want a default value, but might override it
later.</p>
<pre><code class="language-meson"># Not needed on Windows!
my_dep = dependency('', required : false)
if host_machine.system() in ['freebsd', 'netbsd', 'openbsd', 'dragonfly']
  my_dep = dependency('some dep', required : false)
elif host_machine.system() == 'linux'
  my_dep = dependency('some other dep', required : false)
endif

executable(
  'myexe',
  my_sources,
  deps : [my_dep]
)
</code></pre>

    </div>
        




		
	</div>
	<div id="search_results">
		<p>The results of the search are</p>
	</div>
	<div id="footer">
		    
        
<hr>

<div class="license-description">
    Website licensing information are available on the <a href="legal.html">Legal</a> page.
</div>


	</div>
</div>

<div id="toc-column">
	
		<div class="edit-button">
		<a href="https://github.com/mesonbuild/meson/edit/master/docs/builddir/markdown/howtox.md" data-hotdoc-role="edit-button">Edit on github</a>

	</div>
		<div id="toc-wrapper">
		<nav id="toc"></nav>
	</div>
</div>
</div>
</main>


<script src="assets/js/navbar_offset_scroller.js"></script>
</body>
</html>
