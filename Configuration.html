<!DOCTYPE html>
<html lang="en">
<head>

<base href=".">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>Configuration</title>

<link rel="stylesheet" href="assets/css/dark-frontend.css" type="text/css" title="dark">
<link rel="alternate stylesheet" href="assets/css/light-frontend.css" type="text/css" title="light">
<link rel="stylesheet" href="assets/css/bootstrap-toc.min.css" type="text/css">
<link rel="stylesheet" href="assets/css/jquery.mCustomScrollbar.min.css">
<link rel="stylesheet" href="assets/js/search/enable_search.css" type="text/css">

<link rel="stylesheet" href="assets/css/notes.css" type="text/css">

<link rel="stylesheet" href="assets/css/prism-tomorrow.css" type="text/css" title="dark">

<link rel="alternate stylesheet" href="assets/css/prism.css" type="text/css" title="light">

<script src="assets/js/mustache.min.js"></script>
<script src="assets/js/jquery.js"></script>
<script src="assets/js/bootstrap.js"></script>
<script src="assets/js/scrollspy.js"></script>
<script src="assets/js/typeahead.jquery.min.js"></script>
<script src="assets/js/search.js"></script>
<script src="assets/js/compare-versions.js"></script>
<script src="assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="assets/js/bootstrap-toc.min.js"></script>
<script src="assets/js/jquery.touchSwipe.min.js"></script>
<script src="assets/js/anchor.min.js"></script>
<script src="assets/js/tag_filtering.js"></script>
<script src="assets/js/language_switching.js"></script>
<script src="assets/js/styleswitcher.js"></script>

<script src="assets/js/lines_around_headings.js"></script>

<script src="assets/js/prism-core.js"></script>
<script src="assets/js/prism-autoloader.js"></script>
<script src="assets/js/prism_autoloader_path_override.js"></script>
<script src="assets/js/prism-keep-markup.js"></script>
<script src="assets/js/trie.js"></script>

<link rel="icon" type="image/png" href="assets/images/favicon.png">
<link rel="shortcut icon" href="assets/images/favicon.png">

</head>

<body class="no-script
">

<script>
$('body').removeClass('no-script');
</script>

<nav class="navbar navbar-fixed-top navbar-default" id="topnav">
	<div class="container-fluid">
		<div class="navbar-right">
			<a id="toc-toggle">
				<span class="glyphicon glyphicon-menu-right"></span>
				<span class="glyphicon glyphicon-menu-left"></span>
			</a>
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-wrapper" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<span title="light mode switch" class="glyphicon glyphicon-sunglasses pull-right" id="lightmode-icon"></span>
			<form class="navbar-form pull-right" id="navbar-search-form">
                               <div class="form-group has-feedback">
                                       <input type="text" class="form-control input-sm" name="search" id="sidenav-lookup-field" placeholder="search" disabled>
				       <span class="glyphicon glyphicon-search form-control-feedback" id="search-mgn-glass"></span>
                               </div>
                        </form>
		</div>
		<div class="navbar-header">
			<a id="sidenav-toggle">
				<span class="glyphicon glyphicon-menu-right"></span>
				<span class="glyphicon glyphicon-menu-left"></span>
			</a>
			<a id="home-link" href="index.html" class="hotdoc-navbar-brand">
				<img src="assets/images/meson_logo.png" alt="Home">
			</a>
		</div>
		<div class="navbar-collapse collapse" id="navbar-wrapper">
			<ul class="nav navbar-nav" id="menu">
				
<li class="dropdown">
  <a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Modules <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" id="modules-menu">
        <li>
            <a href="CMake-module.html">CMake</a>
        </li>
        <li>
            <a href="Cuda-module.html">CUDA</a>
        </li>
        <li>
            <a href="Dlang-module.html">Dlang</a>
        </li>
        <li>
            <a href="External-Project-module.html">External Project</a>
        </li>
        <li>
            <a href="Fs-module.html">Filesystem</a>
        </li>
        <li>
            <a href="Gnome-module.html">GNOME</a>
        </li>
        <li>
            <a href="Hotdoc-module.html">Hotdoc</a>
        </li>
        <li>
            <a href="i18n-module.html">i18n</a>
        </li>
        <li>
            <a href="Icestorm-module.html">Icestorm</a>
        </li>
        <li>
            <a href="Java-module.html">Java</a>
        </li>
        <li>
            <a href="Keyval-module.html">Keyval</a>
        </li>
        <li>
            <a href="Pkgconfig-module.html">Pkgconfig</a>
        </li>
        <li>
            <a href="Python-3-module.html">Python 3</a>
        </li>
        <li>
            <a href="Python-module.html">Python</a>
        </li>
        <li>
            <a href="Qt4-module.html">Qt4</a>
        </li>
        <li>
            <a href="Qt5-module.html">Qt5</a>
        </li>
        <li>
            <a href="Qt6-module.html">Qt6</a>
        </li>
        <li>
            <a href="Rust-module.html">Rust</a>
        </li>
        <li>
            <a href="Simd-module.html">Simd</a>
        </li>
        <li>
            <a href="SourceSet-module.html">SourceSet</a>
        </li>
        <li>
            <a href="Wayland-module.html">Wayland</a>
        </li>
        <li>
            <a href="Windows-module.html">Windows</a>
        </li>
	</ul>
</li>
<li class="dropdown">
	<a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		Quick References <span class="caret"></span>
	</a>
	<ul class="dropdown-menu" id="quick-refs-menu">
					<li>
				<a href="Reference-manual.html">Functions</a>
			</li>
					<li>
				<a href="Build-options.html">Options</a>
			</li>
					<li>
				<a href="Configuration.html">Configuration</a>
			</li>
					<li>
				<a href="Dependencies.html">Dependencies</a>
			</li>
					<li>
				<a href="Unit-tests.html">Tests</a>
			</li>
					<li>
				<a href="Syntax.html">Syntax</a>
			</li>
			</ul>
</li>
			</ul>
			<div class="hidden-xs hidden-sm navbar-text navbar-center">
				<p><b>The Meson Build System</b></p>
			</div>
		</div>
	</div>
</nav>

<main>
<div data-extension="core" data-hotdoc-in-toplevel="True" data-hotdoc-project="Meson-documentation" data-hotdoc-ref="Configuration.html" class="page_container" id="page-wrapper">
<script src="assets/js/utils.js"></script>

<div class="panel panel-collapse oc-collapsed" id="sidenav" data-hotdoc-role="navigation">
	<script src="assets/js/full-width.js"></script>
  <div id="sitenav-wrapper">
    <iframe src="hotdoc-sitemap.html" id="sitenav-frame"></iframe>
  </div>
</div>

<div id="body">
	<div id="main">
				    <div id="page-description" data-hotdoc-role="main">
        <h1 id="configuration">Configuration</h1>
<p>If there are multiple configuration options, passing them through
compiler flags becomes very burdensome. It also makes the
configuration settings hard to inspect. To make things easier, Meson
supports the generation of configure files. This feature is similar to
one found in other build systems such as CMake.</p>
<p>Suppose we have the following Meson snippet:</p>
<pre><code class="language-meson">conf_data = <a href="Reference-manual_functions.html#configuration_data"><ins>configuration_data()</ins></a>
conf_data.set('version', '1.2.3')
<a href="Reference-manual_functions.html#configure_file"><ins>configure_file</ins></a>(input : 'config.h.in',
               output : 'config.h',
               configuration : conf_data)
</code></pre>
<p>and that the contents of <code>config.h.in</code> are</p>
<pre><code class="language-c">#define VERSION_STR "@version@"
</code></pre>
<p>Meson will then create a file called <code>config.h</code> in the corresponding
build directory whose contents are the following.</p>
<pre><code class="language-c">#define VERSION_STR "1.2.3"
</code></pre>
<p>More specifically, Meson will find all strings of the type <code>@varname@</code>
and replace them with respective values set in <code>conf_data</code>. You can
use a single <code>configuration_data</code> object as many times as you like,
but it becomes immutable after being passed to the <code>configure_file</code>
function. That is, after it has been used once to generate output the
<code>set</code> function becomes unusable and trying to call it causes an error.
Copy of immutable <code>configuration_data</code> is still immutable.</p>
<p>For more complex configuration file generation Meson provides a second
form. To use it, put a line like this in your configuration file.</p>
<pre><code>#mesondefine TOKEN
</code></pre>
<p>The replacement that happens depends on what the value and type of TOKEN is:</p>
<pre><code class="language-c">#define TOKEN     // If TOKEN is set to boolean true.
#undef TOKEN      // If TOKEN is set to boolean false.
#define TOKEN 4   // If TOKEN is set to an integer or string value.
/* undef TOKEN */ // If TOKEN has not been set to any value.
</code></pre>
<p>Note that if you want to define a C string, you need to do the quoting
yourself like this:</p>
<pre><code class="language-meson">conf_data.set('TOKEN', '"value"')
</code></pre>
<p>Since this is such a common operation, Meson provides a convenience
method:</p>
<pre><code class="language-meson">plain_var = 'value'
conf_data.set_quoted('TOKEN', plain_var) # becomes #define TOKEN "value"
</code></pre>
<p>Often you have a boolean value in Meson but need to define the C/C++
token as 0 or 1. Meson provides a convenience function for this use
case.</p>
<pre><code class="language-meson">conf_data.set10(token, boolean_value)
# The line above is equivalent to this:
if boolean_value
  conf_data.set(token, 1)
else
  conf_data.set(token, 0)
endif
</code></pre>
<h2 id="configuring-without-an-input-file">Configuring without an input file</h2>
<p>If the input file is not defined then Meson will generate a header
file with all the entries in the configuration data object. The
replacements are the same as when generating <code>#mesondefine</code> entries:</p>
<pre><code class="language-meson">conf_data.set('FOO', '"string"') =&gt; #define FOO "string"
conf_data.set('FOO', 'a_token')  =&gt; #define FOO a_token
conf_data.set('FOO', true)       =&gt; #define FOO
conf_data.set('FOO', false)      =&gt; #undef FOO
conf_data.set('FOO', 1)          =&gt; #define FOO 1
conf_data.set('FOO', 0)          =&gt; #define FOO 0
</code></pre>
<p>In this mode, you can also specify a comment which will be placed
before the value so that your generated files are self-documenting.</p>
<pre><code class="language-meson">conf_data.set('BAR', true, description : 'Set BAR if it is available')
</code></pre>
<p>Will produce:</p>
<pre><code class="language-c">/* Set BAR if it is available */
#define BAR
</code></pre>
<h2 id="dealing-with-file-encodings">Dealing with file encodings</h2>
<p>The default Meson file encoding to configure files is utf-8. If you
need to configure a file that is not utf-8 encoded the <code>encoding</code>
keyword will allow you to specify which file encoding to use. It is
however strongly advised to convert your non utf-8 file to utf-8
whenever possible. Supported file encodings are those of python3, see
<a href="https://docs.python.org/3/library/codecs.html#standard-encodings">standard-encodings</a>.</p>
<h2 id="using-dictionaries">Using dictionaries</h2>
<p>Since <em>0.49.0</em> <a href="Reference-manual_functions.html#configuration_data"><ins><code>configuration_data()</code></ins></a> takes an optional dictionary as
first argument. If provided, each key/value pair is added into the
<code>configuration_data</code> as if <code>set()</code> method was called for each of them.
<a href="Reference-manual_functions.html#configure_file"><ins><code>configure_file()</code></ins></a>'s <code>configuration</code> kwarg also accepts a dictionary
instead of a configuration_data object.</p>
<p>Example:</p>
<pre><code class="language-meson">cdata = configuration_data({
  'STRING' : '"foo"',
  'INT' : 42,
  'DEFINED' : true,
  'UNDEFINED' : false,
})

configure_file(output : 'config1.h',
  configuration : cdata,
)

configure_file(output : 'config2.h',
  configuration : {
    'STRING' : '"foo"',
    'INT' : 42,
    'DEFINED' : true,
    'UNDEFINED' : false,
  }
)

</code></pre>
<h1 id="a-full-example">A full example</h1>
<p>Generating and using a configuration file requires the following steps:</p>
<ul>
<li>generate the file</li>
<li>create an include directory object for the directory that holds the file</li>
<li>use it in a target</li>
</ul>
<p>We are going to use the traditional approach of generating a header
file in the top directory. The common name is <code>config.h</code> but we're
going to use an unique name. This avoids the problem of accidentally
including the wrong header file when building a project with many
subprojects.</p>
<p>At the top level we generate the file:</p>
<pre><code class="language-meson">conf_data = configuration_data()
# Set data
configure_file(input : 'projconfig.h.in',
  output : 'projconfig.h',
  configuration : conf_data)
</code></pre>
<p>Immediately afterwards we generate the include object.</p>
<pre><code class="language-meson">configuration_inc = include_directories('.')
</code></pre>
<p>Finally we specify this in a target that can be in any subdirectory.</p>
<pre><code class="language-meson">executable(..., include_directories : configuration_inc)
</code></pre>
<p>Now any source file in this target can include the configuration
header like this:</p>
<pre><code class="language-c">#include&lt;projconfig.h&gt;
</code></pre>

    </div>
        




		
	</div>
	<div id="search_results">
		<p>The results of the search are</p>
	</div>
	<div id="footer">
		    
        
<hr>

<div class="license-description">
    Website licensing information are available on the <a href="legal.html">Legal</a> page.
</div>


	</div>
</div>

<div id="toc-column">
	
		<div class="edit-button">
		<a href="https://github.com/mesonbuild/meson/edit/master/docs/markdown/Configuration.md" data-hotdoc-role="edit-button">Edit on GitHub</a>

	</div>
		<div id="toc-wrapper">
		<nav id="toc"></nav>
	</div>
</div>
</div>
</main>


<script src="assets/js/navbar_offset_scroller.js"></script>
</body>
</html>
